<app-cashier-layout></app-cashier-layout>
<div *ngIf="message" class="message-box" [ngClass]="messageType">
  {{ message }}
</div>

<div class="container mt-5 sales-checkout">
  <h1>Sales & Checkout</h1>

  <!-- Row wrapper -->
  <div class="row">
    
    <!-- Left Side (Products - 3/4 width) -->
    <div class="col-lg-8 col-md-8 col-13">
      <div class="section-header">
        <h2>Products</h2>
      </div>

      <!-- Filters Section: Search and Category in one row -->
<div class="filters mb-3 d-flex align-items-center gap-2">
  <input
    type="text"
    placeholder="Search products by name..."
    class="form-control"
    style="flex: 1"
    [(ngModel)]="searchTerm"
  />

  <select
    class="form-control"
    style="width: 200px"
    [(ngModel)]="selectedCategory"
  >
    <option value="">All Categories</option>
    <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
  </select>
</div>

      <!-- Products grid -->
      <!-- Products grid -->
<div class="products-grid">
  <div *ngFor="let product of filteredProducts" class="product-col">
    <div class="card product-card h-100">
      <div class="card-body">
        <h5 class="card-title">{{ product.name }}</h5>
        <p class="card-text category mb-1">{{ product.category }}</p>
        <p class="card-text price">₹{{ product.price }}</p>
        <p class="card-text stock">Stock: {{ product.stock }}</p>

        <!-- Quantity and Add to Cart only if in stock -->
        <input
          type="number"
          [(ngModel)]="product.quantity"
          min="1"
          [max]="product.stock"
          class="form-control mb-2 qty-input"
          [disabled]="product.stock === 0"
        />

        <button
          (click)="updateTotal()"
          class="btn btn-primary w-100"
          [disabled]="product.stock === 0"
        >
          Add to Cart
        </button>
      </div>
    </div>
  </div>
  <div *ngIf="filteredProducts.length === 0" class="no-products">
    No products found.
  </div>
</div>
    <!-- Right Side (Cart - 1/4 width) -->
    <div class="col-lg-4 col-md-4 col-12">
  <div class="fixed-cart">

      <div class="section-header">
        <h2>Shopping Cart</h2>
      </div>

      <div class="card cart-panel">
        <div class="card-body">
          <ul class="list-group cart-list">
            <ng-container *ngFor="let product of products">
              <li class="list-group-item cart-item" *ngIf="product.quantity > 0">
                <span class="item-name">{{ product.name }} x {{ product.quantity }}</span>
                <span class="item-price">₹{{ product.price * product.quantity }}</span>
              </li>
            </ng-container>
          </ul>

          <div *ngIf="totalAmount > 0" class="mt-3 totals">
            <strong>Total: ₹{{ totalAmount }}</strong>

            <!-- Customer Info Fields -->
            <div class="mt-3">
              <label class="form-label">Customer Name</label>
              <input
                type="text"
                class="form-control mb-2"
                placeholder="Enter Customer Name"
                [(ngModel)]="customerInfo"
              />

              <label class="form-label">Payment Method</label>
              <select class="form-control mb-3" [(ngModel)]="paymentMethod">
                <option value="" disabled selected>Select Payment Method</option>
                <option value="Cash">Cash</option>
                <option value="Debit Card">Debit Card</option>
                <option value="Credit Card">Credit Card</option>
              </select>
            </div>

            <div class="btn-group mt-2 action-buttons">
              <button (click)="clearCart()" class="btn btn-warning">Clear Cart</button>
              <button (click)="checkout()" class="btn btn-success">Checkout</button>
            </div>
          </div>

          <div *ngIf="totalAmount === 0" class="mt-3 empty-msg">
            Cart is empty
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>